<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>ML - Confusion Matrix</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="../../assets/img/web-icon.png" rel="icon">
  <link href="../../assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Roboto:300,300i,400,400i,500,500i,700,700i&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../../assets/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="../../assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="../../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="../../assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="../../assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="../../assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="../../assets/css/style.css" rel="stylesheet">
  <link href="../../assets/css/prism.css" rel="stylesheet">

</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top ">
    <div class="container">

      <div class="logo float-left">
        <h1 class="text-light"><a href="../../index.html"><span>pyDataScientist</span></a></h1>
      </div>

      <nav class="nav-menu float-right d-none d-lg-block">
        <ul>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../projects.html">Projects</a></li>
          <li class="active drop-down"><a href="../../notes.html">Tutorials</a>
            <ul>
              <li><a href="../../notes.html#Pandas">Pandas</a></li>
              <li class="drop-down"><a href="../../notes.html#Machine-Learning">Machine Learning</a>
                <ul>
                  <li><a href="linear_regression.html">Linear Regression</a></li>
                  <li><a href="linear_regression.html">Support Vector Machines</a></li>
                  <li><a href="linear_regression.html">Naive Bayes</a></li>
                  <li><a href="linear_regression.html">Decision Trees</a></li>
                  <li><a href="linear_regression.html">Ensemble Methods</a></li>
                </ul>
              </li>
              <li><a href="../../notes.html#Linear-Algebra">Linear Algebra</a></li>
              <li><a href="../../notes.html#Visualization">Visualization</a></li>
              <li><a href="../../notes.html#Jupyter-Notebook">Jupyter Notebook</a></li>
              <li><a href="../../notes.html#Git">Git</a></li>
              <li><a href="../../notes.html#Bash">Bash</a></li>
              <li><a href="../../notes.html#Deep-Learning">Deep Learning</a></li>
              <li><a href="../../notes.html#Conda">Conda</a></li>
              <li><a href="../../notes.html#Numerical-Methods">Numerical Methods</a></li>
              <li><a href="../../notes.html#Big-Data">Big Data</a></li>
              <li><a href="../../notes.html#Classification">Classification</a></li>
              <li><a href="../../notes.html#Pattern-Recognition">Pattern Recognition</a></li>
              <li><a href="../../notes.html#SQL">SQL</a></li>
            </ul>
          </li>
          <li><a href="../../about.html">About Me</a></li>
          <li><a href="../../contact.html">Contact</a></li>
        </ul>
      </nav><!-- .nav-menu -->

    </div>
  </header><!-- End Header -->

  <main id="main">

    <!-- ======= About Us Section ======= -->
    <section class="breadcrumbs">
      <div class="container">

        <div class="d-flex justify-content-between align-items-center">
          <h2>ML</h2>
          <ol>
            <li><a href="../../notes.html#Machine-Learning">ML</a></li>
            <li>Confusion Matrix</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- End Header -->
    <section class="tutorials" data-aos="fade-up" data-aos-easing="ease-in-out" data-aos-duration="1000">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h3>Confusion Matrix</h3>
            <p>
              Confusion matrix is one of the best ways to evaluate the accuracy of a classifier. It summarizes the results of testing a classifier by dividing the observations into correct and incorrect predictions, for each class (class I, class II, class III etc.).
            </p>
            <pre class="prettyprint lang-language">
<code class="language-python"># Create dummy data
import numpy as np
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay
# Random distributions of size 20 with three class labels 1, 2, and 3
y_obs = np.random.randint(low=1, high=4, size=30)
y_pred = np.random.randint(low=1, high=4, size=30)
print(f'true classes: {y_obs}')
print(f'pred classes: {y_pred}')</code></pre>
            <pre>true classes: [1 3 1 2 3 3 2 1 2 3 3 1 1 3 3 2 1 1 2 3 1 3 1 2 2 2 2 2 3 2]
pred classes: [3 3 2 2 3 2 1 1 3 2 2 1 2 1 2 2 1 3 3 3 3 3 2 2 1 2 1 2 1 1]</pre>
            <pre class="prettyprint lang-language">
<code class="language-python">cm = confusion_matrix(y_obs, y_pred)
cm</code></pre>
            <pre>array([[3, 3, 3],
       [4, 5, 2],
       [2, 4, 4]])</pre>
            <pre class="prettyprint lang-language">
<code class="language-python">import matplotlib.pyplot as plt
fig, ax = plt.subplots(1, 1, dpi=150)
cm_plot = ConfusionMatrixDisplay(confusion_matrix=cm, 
                                 display_labels=["class_1", "class_2", "class_3"])
cm_plot.plot(ax=ax);</code></pre>
            <img src="conf_mat_0.png">
            <p>
              <b>Note</b>: <code style="library">sklearn</code> uses the following convention to show the confusion matrix
            
              <table class="table table-bordered" style="border-color:transparent; white-space: nowrap; float:left; margin:1em 0em 1em 0em; padding: 0em; text-align:center;">
                <tbody>
                <tr style="height: 2em;">
                  <th style="background:white; border:none;" colspan="2" rowspan="2"></th>
                  <th colspan="2" style="vertical-align: middle; height: 5em; background: #f9f9f9;">
                    Predicted class
                  </th>
                  <th style="vertical-align: middle; border: none; background: white; width: 10em;"></th>
                </tr>
                <tr style="height: 2em;"> 
                  <th style="vertical-align: middle; height: 5em; background: white; width: 10em;">
                    Negative
                  </th>
                  <th style="vertical-align: middle; background: white; width: 10em;">
                    Positive
                  </th>
                </tr>
                <tr style=" background:none; line-height: 0.75em; background: #f9f9f9;">
                  <th rowspan="2" style="padding: 0.2em; transform: rotate(-90deg);-webkit-transform:  rotate(-deg);vertical-align: middle;">
                    <div>
                      Observed<br><br>class
                    </div>
                  </th>
                  <th style="vertical-align: middle;background: white; width: 10em;height: 5em;">
                    Negative
                  </th>
                  <td style="vertical-align: middle; background: #d8f3e3;">
                    <span class="latex_math">True Negative (TN)</span>
                  </td>
                  <td style="vertical-align: middle; background: #ffccda; font-family: ">
                    <span class="latex_math">False Positive (FP)</span>
                  </td>
                </tr>
                <tr style="background:none; height: 5em;">
                  <th style="vertical-align: middle;">
                    Positive
                  </th>
                  <td style="background: #ffccda; vertical-align: middle;">
                    <span class="latex_math">False Negative (FN)</span>
                  </td>
                  <td style="background: #d8f3e3; vertical-align: middle;">
                    <span class="latex_math">True Positive (TP)</span>
                  </td>
                </tr>
                </tbody>
              </table>
            </p>
            <p>
<!--             <table class="table table-bordered" style="border-color:transparent;white-space: nowrap; line-height: 1em; padding: 0em; text-align:center;vertical-align: bottom;">
              <tbody>
              <tr style="height: 2em;width: 2em;">
                <th style="background:#d8f3e3;"><b>TN</b></th>
                <th style="background:#ffccda;"><b>FP</b></th>
              </tr>
              <tr style="height: 2em;width: 2em;">
                <td style="background: #ffccda;"><b>FN</b></td>
                <td style="background: #d8f3e3;"><b>TP</b></td>
              </tr>
              </tbody>
            </table>
            <p> -->
              where TN, FP, FN, and TP stand for <span style="color: #088E15;">True</span> Negative, <span style="color: #FF0D0D;">False</span> Positive, <span style="color: #FF0D0D;">False</span> Negative, and <span style="color: #088E15;">True</span> Positive, respectively. This is important as most references use a different convention (see <a href="classification_metrics.html#tpfn">Classification Metrics</a> tutorial for more on this). <code style="library">sklearn</code> assigns the predictions to columns, and observations to rows. If the label argument is not specified, the labels are sorted numerically or alphabetically from left to right (for prediction labels) and top to bottom (for true labels). 
            </p>
            <p>To summarize, according to <code style="library">sklearn</code> convention:
              <ul>
                <li>The first column contains, negative predicted labels (TN and FN)</li>
                <li>The second column contains, positive predicted labels (TP and FP)</li>
                <li>The first row contains negative observed labels (TN and FP)</li>
                <li>The second row contains positive observed labels (TP and FN)</li>
                <li>The diagonal contains the number of correctly predicted labels (TN and TP)</li>
              </ul>
            </p>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col text-center">
            <a class="btn btn-notebook" role="button" href="https://github.com/alineu/pyDataScintist-Notebooks/blob/main/ML/confusion_matrix.ipynb">Link to the <strong>ipython notebook</strong></a>
          </div>
        </div>
      </div>
    </section>
  </main>
      
  <!-- ======= Footer ======= -->
  
  <footer id="footer" data-aos="fade-up" data-aos-easing="ease-in-out" data-aos-duration="500">

    <div class="footer-newsletter">
      <div class="container">
        <div class="row">
          <div class="col-lg-6">
            <h4>Newsletter</h4>
            <p>Subscribe here to get notified when a new material is posted</p>
          </div>
          <div class="col-lg-6">
            <form action="" method="post">
              <input type="email" name="email"><input type="submit" value="Subscribe">
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-top">
      <div class="container">
        <div class="row">

          <div class="col-lg-4 col-md-6 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Home</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">About Me</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Projects</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Tutorials</a></li>
            </ul>
          </div>

          <div class="col-lg-4 col-md-6 footer-contact">
            <h4>Contact</h4>
            <p>
              913 Boylston Street<br>
              Boston, MA 02115<br>
              United States <br><br>
              <strong>Phone:</strong> +1 617 460 0555<br>
              <strong>Email:</strong> alimehdirahim@gmail.com<br>
            </p>
          </div>

          <div class="col-lg-4 col-md-6 footer-info">
            <h3>About Me</h3>
            <p>A data science enthusiast! I love developing new machine learning algorithms to address real-world problems. I try to learn something new on a daily basis.</p>
            <div class="social-links mt-3">
              <a href="https://github.com/alineu" class="Github"><i class="bx bxl-github"></i></a>
              <a href="https://www.linkedin.com/in/alimehdizadehrahimi/" class="linkedin"><i class="bx bxl-linkedin"></i></a>
              <a href="https://twitter.com/estoyali" class="twitter"><i class="bx bxl-twitter"></i></a>
              <a href="https://instagram.com/aliexplores" class="instagram"><i class="bx bxl-instagram"></i></a>
              </div>
          </div>

        </div>
      </div>
    </div>

    <div class="container">
      <div class="copyright">
        &copy; Copyright 2020 <strong><span>Ali Mehdizadeh</span></strong>. All Rights Reserved
      </div>
      <div class="credits">

        Page design is adopted from <a href="https://bootstrapmade.com/">BootstrapMade</a>.<br>Page icons were taken from <a href="https://www.flaticon.com">flaticon.com</a>. 
     
      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

  <!-- Vendor JS Files -->
  <script src="../../assets/vendor/jquery/jquery.min.js"></script>
  <script src="../../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../../assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="../../assets/vendor/php-email-form/validate.js"></script>
  <script src="../../assets/vendor/venobox/venobox.min.js"></script>
  <script src="../../assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="../../assets/vendor/counterup/counterup.min.js"></script>
  <script src="../../assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="../../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="../../assets/vendor/prism/prism.js"></script>
  <script src="../../assets/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="../../assets/js/main.js"></script>

  <!-- MathJax JS File -->
  <script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [["$", "$"], ["\\(", "\\)"]],
        processEscapes: true
    }
});
</script>
</script>
</body>

</html>